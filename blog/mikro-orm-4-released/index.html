<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135618258-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-135618258-1",{})</script>
<script src="/js/custom.js"></script>

<title data-react-helmet="true">MikroORM 4: Filling the Gaps | MikroORM</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="MikroORM 4: Filling the Gaps | MikroORM"><meta data-react-helmet="true" name="description" content="After 4 months of active development, I am thrilled to announce the release of [MikroORM 4](http://github.com/mikro-orm/mikro-orm). When I started to work on v4, the goal was to make it relatively small release, mainly to drop support for TypeScript 3.6 and Node.js 8, and to split the project into multiple packages, so we can have more fine grained control over the dependencies (mainly because of ts-morph having TS as a runtime dependency)."><meta data-react-helmet="true" property="og:description" content="After 4 months of active development, I am thrilled to announce the release of [MikroORM 4](http://github.com/mikro-orm/mikro-orm). When I started to work on v4, the goal was to make it relatively small release, mainly to drop support for TypeScript 3.6 and Node.js 8, and to split the project into multiple packages, so we can have more fine grained control over the dependencies (mainly because of ts-morph having TS as a runtime dependency)."><meta data-react-helmet="true" name="twitter:card" content="summary">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.bc8338fb.css">


<link rel="preload" href="/styles.ab677cec.js" as="script">

<link rel="preload" href="/runtime~main.1a7df383.js" as="script">

<link rel="preload" href="/main.c2ef541e.js" as="script">

<link rel="preload" href="/1.7f8e4ee9.js" as="script">

<link rel="preload" href="/2.062ceb4d.js" as="script">

<link rel="preload" href="/3.885aa520.js" as="script">

<link rel="preload" href="/ccc49370.3426701b.js" as="script">

<link rel="preload" href="/8f6b4fa6.5840ddae.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}function e(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}var n=window.matchMedia("(prefers-color-scheme: dark)");n.addListener((function(n){null===e()&&t(n.matches?"dark":"")}));var a=e();null!==a?t(a):n.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="MikroORM"><strong></strong></a><a class="navbar__item navbar__link" data-type="versions" href="/versions">4.0.1</a><a class="navbar__item navbar__link" href="/docs/installation">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://join.slack.com/t/mikroorm/shared_invite/enQtNTM1ODYzMzM4MDk3LWM4ZDExMjU5ZDhmNjA2MmM3MWMwZmExNjhhNDdiYTMwNWM0MGY5ZTE3ZjkyZTMzOWExNDgyYmMzNDE1NDI5NjA" title="Chat on Slack">Slack</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/mikro-orm/mikro-orm" title="View on GitHub">GitHub</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/MikroORM" title="Twitter">Twitter</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="MikroORM"><strong></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" data-type="versions" href="/versions">4.0.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/installation">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://join.slack.com/t/mikroorm/shared_invite/enQtNTM1ODYzMzM4MDk3LWM4ZDExMjU5ZDhmNjA2MmM3MWMwZmExNjhhNDdiYTMwNWM0MGY5ZTE3ZjkyZTMzOWExNDgyYmMzNDE1NDI5NjA" title="Chat on Slack">Slack</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/mikro-orm/mikro-orm" title="View on GitHub">GitHub</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/MikroORM" title="Twitter">Twitter</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--xl"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_2RZH">MikroORM 4: Filling the Gaps</h1><div class="margin-bottom--sm"><time datetime="2020-09-08T00:00:00.000Z" class="blogPostDate_3tRe">September 8, 2020</time></div><div class="avatar margin-bottom--md"><a class="avatar__photo-link" href="https://github.com/B4nan" target="_blank" rel="noreferrer noopener"><img class="avatar__photo" src="https://avatars1.githubusercontent.com/u/615580?s=460&amp;v=4" alt="Martin Adámek"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/B4nan" target="_blank" rel="noreferrer noopener">Martin Adámek</a></h4><small class="avatar__subtitle">Author of MikroORM</small></div></div></header><section class="markdown"><p>After 4 months of active development, I am thrilled to announce the release of <a href="http://github.com/mikro-orm/mikro-orm">MikroORM 4</a>. When I started to work on v4, the goal was to make it relatively small release, mainly to drop support for TypeScript 3.6 and Node.js 8, and to split the project into multiple packages, so we can have more fine grained control over the dependencies (mainly because of ts-morph having TS as a runtime dependency).</p><blockquote><p>But what a major release would that be, without having a bunch of new features as well, right?</p></blockquote><p><img src="https://cdn-images-1.medium.com/max/1024/0*JU7VN0bgkL57RnZJ"></p><figcaption>Photo by <a href="https://unsplash.com/@ryoji__iwata?utm_source=medium&amp;utm_medium=referral">Ryoji Iwata</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral">Unsplash</a></figcaption><p></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="in-case-you-dont-know"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#in-case-you-dont-know" title="Direct link to heading">#</a>In case you don’t know…</h3><p>If you never heard of <a href="https://github.com/mikro-orm/mikro-orm">MikroORM</a>, it’s a TypeScript data-mapper ORM with Unit of Work and Identity Map. It supports MongoDB, MySQL, PostgreSQL and SQLite drivers currently. Key features of the ORM are:</p><ul><li><a href="https://github.com/mikro-orm/mikro-orm#implicit-transactions">Implicit transactions</a></li><li><a href="https://github.com/mikro-orm/mikro-orm#changeset-based-persistence">ChangeSet based persistence</a></li><li><a href="https://mikro-orm.io/docs/identity-map/">Identity map</a></li></ul><p><img src="https://cdn-images-1.medium.com/max/1024/0*VEfH0Y8e_cMVXad1.png"></p><p>You can read the full <a href="https://medium.com/dailyjs/introducing-mikro-orm-typescript-data-mapper-orm-with-identity-map-9ba58d049e02">introductory article here</a> or <a href="https://mikro-orm.io/">browse through the docs</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="quick-summary-of-3x-releases"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#quick-summary-of-3x-releases" title="Direct link to heading">#</a>Quick summary of 3.x releases</h3><p>Before I dive into all the things v4, let’s recap the major features that landed in 3.x releases:</p><ul><li><a href="https://mikro-orm.io/docs/entity-schema">Defining entities via</a><a href="https://mikro-orm.io/docs/entity-schema">EntitySchema</a></li><li><a href="https://mikro-orm.io/docs/propagation">Propagation of changes to m:1/1:1 to inverse sides</a></li><li><a href="https://mikro-orm.io/docs/usage-with-mongo#transactions">Transactions in MongoDB</a></li><li><a href="https://mikro-orm.io/docs/composite-keys">Composite primary keys</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="monorepo"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#monorepo" title="Direct link to heading">#</a>Monorepo</h3><p>The first major change I want to talk about is the split into multiple packages. As mentioned above, the biggest motivation for this change was to get rid of TS as a runtime dependency, when it is not needed. Another nice example is knex, which is used as a base layer for SQL driver, but has no meaning for mongodb users. Lastly, it turned out Highlight.js, that was used for query highlighting, is also quite fat and slow, so I ended up writing custom highlighters that are built for CLI and are (almost) dependency free.</p><p>In v4, there are 12 packages and 2 highlighters, you install only what you use, and you have control over what is needed in production and what is just a dev dependency. This is especially useful for serverless users, where cold start speeds matter.</p><p>It felt natural to offer some shortcuts on the EntityManager and EntityRepository level, so we now have flavours of those classes in place, that offer things like em.execute(sql) or em.aggregate(). To access those driver specific methods, be sure to use the classes from driver packages:</p><p>{% gist <a href="https://gist.github.com/B4nan/adcbf0ada5b18a9e1a9699e998d9519c">https://gist.github.com/B4nan/adcbf0ada5b18a9e1a9699e998d9519c</a> %}</p><blockquote><p>Database connectors like pg or sqlite3 are now dependencies of the driver packages (e. g. @mikro-orm/sqlite).</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="filters"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#filters" title="Direct link to heading">#</a><strong>Filters</strong></h3><p>Probably the most interesting feature of v4 are <a href="https://mikro-orm.io/docs/filters/">filters</a>, also known as association scopes. They allow you to define data visibility rules, both global and bound to entity. One common application of filters are soft deletes, or automatic tenant conditions.</p><p>{% gist <a href="https://gist.github.com/B4nan/7b8dd8c84e71bf10d76745cba7f3961f">https://gist.github.com/B4nan/7b8dd8c84e71bf10d76745cba7f3961f</a> %}</p><p>Filters are applied to those methods of EntityManager: find(), findOne(), findAndCount(), findOneOrFail(), count(), nativeUpdate() and nativeDelete(). Filters can be parametric, the parameter can be also in form of callback (possibly async). You can also make the filter enabled by default.</p><blockquote><p>Filter can be defined at the entity level, dynamically via EM (global filters) or in the ORM configuration.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="global-filters"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#global-filters" title="Direct link to heading">#</a>Global Filters</h4><p>We can also register filters dynamically via EntityManager API. We call such filters global. They are enabled by default (unless disabled via last parameter in addFilter() method), and applied to all entities. You can limit the global filter to only specified entities.</p><blockquote><p><em>Filters as well as filter params set on the EM will be copied to all its forks.</em></p></blockquote><p>{% gist <a href="https://gist.github.com/B4nan/836afb7a1a7f42d13c9f9722df211020">https://gist.github.com/B4nan/836afb7a1a7f42d13c9f9722df211020</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="eventsubscribers-and-flush-events"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#eventsubscribers-and-flush-events" title="Direct link to heading">#</a><strong>EventSubscribers and flush events</strong></h3><p>As opposed to regular lifecycle hooks, we can now use <a href="https://mikro-orm.io/docs/lifecycle-hooks/#eventsubscriber">EventSubscriber</a> to hook to multiple entities or if you do not want to pollute the entity prototype. All methods are optional, if you omit the getSubscribedEntities() method, it means you are subscribing to all entities.</p><p>{% gist <a href="https://gist.github.com/B4nan/d8d73a182170843fa611f9ecd88691a6">https://gist.github.com/B4nan/d8d73a182170843fa611f9ecd88691a6</a> %}</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="flush-events"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#flush-events" title="Direct link to heading">#</a>Flush events</h4><p>There is a <a href="https://mikro-orm.io/docs/lifecycle-hooks/#flush-events">special kind of events</a> executed during the commit phase (flush operation). They are executed before, during and after the flush, and they are not bound to any entity in particular.</p><ul><li>beforeFlush is executed before change sets are computed, this is the only event where it is safe to persist new entities.</li><li>onFlush is executed after the change sets are computed.</li><li>afterFlush is executed as the last step just before the flush call resolves. it will be executed even if there are no changes to be flushed.</li></ul><p>Flush event args will not contain any entity instance, as they are entity agnostic. They do contain additional reference to the UnitOfWork instance.</p><p>Following example demonstrates the hidden power of flush events — they allow to hook into the change set tracking, adjusting what will be persisted and how. Here we try to find a CREATE change set for entity FooBar, and if there is any, we automatically create a new FooBaz entity, connecting it to the FooBar one. This kind of operations was previously impossible, as in regular lifecycle hooks we can only adjust the entity that triggers the event.</p><p>{% gist <a href="https://gist.github.com/B4nan/b4ad60b1b3a3ce802469de375077ec42">https://gist.github.com/B4nan/b4ad60b1b3a3ce802469de375077ec42</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="joined-loading-strategy"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#joined-loading-strategy" title="Direct link to heading">#</a>Joined loading strategy</h3><p>Loading of complex relations now support so called <a href="https://mikro-orm.io/docs/loading-strategies/">JOINED strategy</a>. Its name is quite self-explanatory — instead of the default (SELECT_IN) strategy, it uses single SQL query and maps the result to multiple entities.</p><p>{% gist <a href="https://gist.github.com/B4nan/02a55833ace1bb320f4256cfa2444e78">https://gist.github.com/B4nan/02a55833ace1bb320f4256cfa2444e78</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="single-table-inheritance"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#single-table-inheritance" title="Direct link to heading">#</a><strong>Single Table Inheritance</strong></h3><p><a href="https://mikro-orm.io/docs/inheritance-mapping/#single-table-inheritance">STI is an inheritance mapping strategy</a> where all classes of a hierarchy are mapped to a single database table. In order to distinguish which row represents which type in the hierarchy a so-called discriminator column is used.</p><blockquote><p>If no discriminator map is provided, it will be generated automatically.</p></blockquote><p>Following example defines 3 entities — they will all be stored in a single database table called person, with a special column named type, that will be used behind the scenes to know what class should be used to represent given row/entity.</p><p>{% gist <a href="https://gist.github.com/B4nan/5bb15df276b243c275bb373f0458ee44">https://gist.github.com/B4nan/5bb15df276b243c275bb373f0458ee44</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="embeddables"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#embeddables" title="Direct link to heading">#</a><strong>Embeddables</strong></h3><p><a href="https://mikro-orm.io/docs/embeddables/">Embeddables</a> are classes which are not entities themselves, but are embedded in entities and can also be queried. You’ll mostly want to use them to reduce duplication or separating concerns. Value objects such as date range or address are the primary use case for this feature.</p><blockquote><p>Embeddables can only contain properties with basic @Property() mapping.</p></blockquote><p>Following example will result in a single database table, where the address fields will be inlined (with prefix) to the user table.</p><p>{% gist <a href="https://gist.github.com/B4nan/b185efab7a265b0381812a4fb53969de">https://gist.github.com/B4nan/b185efab7a265b0381812a4fb53969de</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="lazy-scalar-properties"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#lazy-scalar-properties" title="Direct link to heading">#</a><strong>Lazy scalar properties</strong></h3><p>In MikroORM 4, we can mark any property as <a href="https://mikro-orm.io/docs/defining-entities#lazy-scalar-properties">lazy: true</a> to omit it from the select clause. This can be handy for properties that are too large and you want to have them available only some times, like a full text of an article.</p><p>When we need such value, we can use populate parameter to load it as if it was a reference.</p><blockquote><p>If the entity is already loaded and you need to populate a lazy scalar property, you might need to pass refresh: true in the FindOptions.</p></blockquote><p>{% gist <a href="https://gist.github.com/B4nan/c1c232603ecbce5a15cba3fc9f504239">https://gist.github.com/B4nan/c1c232603ecbce5a15cba3fc9f504239</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="computed-properties"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#computed-properties" title="Direct link to heading">#</a><strong>Computed Properties</strong></h3><p>Another small enhancement in entity definition is the <a href="https://mikro-orm.io/docs/defining-entities/#formulas">@Formula() decorator</a>. It can be used to map some SQL snippet to your entity. The SQL fragment can be as complex as you want and even include subselects.</p><p>{% gist <a href="https://gist.github.com/B4nan/15ef341965979c9cb1804f6771292363">https://gist.github.com/B4nan/15ef341965979c9cb1804f6771292363</a> %}</p><blockquote><p>Formulas will be added to the select clause automatically. In case you are facing problems with NonUniqueFieldNameException, you can define the formula as a callback that will receive the entity alias in the parameter.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="type-safe-references"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#type-safe-references" title="Direct link to heading">#</a><strong>Type-safe references</strong></h3><p>Next feature I would like to mention is rather hidden, and is a bit experimental. In MikroORM 4, all EntityManager and EntityRepository methods for querying entities (e.g. find()) will now return special Loaded type, where we automatically infer what relations are populated. It dynamically adds special get() method to both Reference and Collection instances, that you can use to ensure the relation is loaded on the type level.</p><p>{% gist <a href="https://gist.github.com/B4nan/6e49c78a67333b79fb0d2233f3fceba4">https://gist.github.com/B4nan/6e49c78a67333b79fb0d2233f3fceba4</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="querybuilder-improvements"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#querybuilder-improvements" title="Direct link to heading">#</a><strong>QueryBuilder improvements</strong></h3><p>There have been quite a lot of small adjustments in QueryBuilder, to name a few things:</p><ul><li>support for subqueries and qb.ref()</li><li>using sql snippets with qb.raw()</li><li>pagination support via subselects (QueryFlag.PAGINATE)</li><li>update &amp; delete queries with auto-joining</li></ul><p>Here are few examples of those features in action:</p><p>{% gist <a href="https://gist.github.com/B4nan/8acf4ec57aabad78bfe7b17bb9aa5cc0">https://gist.github.com/B4nan/8acf4ec57aabad78bfe7b17bb9aa5cc0</a> %}</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="and-many-many-more"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#and-many-many-more" title="Direct link to heading">#</a><strong>And many many more…</strong></h3><ul><li>em.begin/commit/rollback() methods are back</li><li>using file globs for discovery (**/*.entity.ts)</li><li>custom driver exceptions (UniqueConstraintViolationException, …)</li><li>adding items to not-initialized collections</li><li>bulk deletes and other performance improvements</li><li>inference of custom repository type (EntityRepositoryType)</li><li><a href="https://mikro-orm.io/docs/serializing#property-serializers">property serializers</a></li></ul><p>See the <a href="https://github.com/mikro-orm/mikro-orm/blob/master/CHANGELOG.md">changelog</a> for full list of new features and fixes.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="more-example-integrations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#more-example-integrations" title="Direct link to heading">#</a><strong>More example integrations</strong></h4><ul><li>Koa: <a href="https://github.com/mikro-orm/koa-ts-example-app">https://github.com/mikro-orm/koa-ts-example-app</a></li><li>GraphQL: <a href="https://github.com/driescroons/mikro-orm-graphql-example">https://github.com/driescroons/mikro-orm-graphql-example</a></li><li>Serverless: <a href="https://github.com/thomaschaaf/serverless-mikro-orm-example-app">https://github.com/thomaschaaf/serverless-mikro-orm-example-app</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="upgrading"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#upgrading" title="Direct link to heading">#</a>Upgrading</h3><p>For smooth upgrading, read the full <a href="https://mikro-orm.io/docs/upgrading-v3-to-v4">upgrading guide</a>. Here are few notable breaking changes:</p><ul><li>Default metadata provider is ReflectMetadataProvider, to use ts-morph, you need to install it from @mikro-orm/reflection and explicitly provide it in the ORM configuration. If you want to use ReflectMetadataProvider, be sure to see the <a href="https://mikro-orm.io/docs/metadata-providers/#limitations-and-requirements">list of its limitations</a>.</li><li>TsMorphMetadataProvider now uses *.d.ts files in production mode, so be sure to enable them in your tsconfig.json.</li><li>@mikro-orm/core package is not dependent on knex, and therefore cannot provide methods like createQueryBuilder() — instead, those methods exist on SqlEntityManager. You can import it from the driver package, e.g. import { EntityManager } from &#x27;@mikro-orm/mysql;.</li><li>To use CLI, you need to install @mikro-orm/cli package.</li><li>When using folder based discovery, the options entitiesDirs and entitiesDirsTs are now removed in favour of entities and entitiesTs. You can now mix entity references with folders and file globs, negative globs are also supported.</li><li>For Nest.js users, there is a new <a href="https://github.com/mikro-orm/nestjs">@mikro-orm/nestjs</a> package, which is a fork of the <a href="https://github.com/dario1985/nestjs-mikro-orm">nestjs-mikro-orm</a> module with changes needed for<br>MikroORM 4.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="whats-next"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#whats-next" title="Direct link to heading">#</a>What’s next?</h3><p>Here are some features I’d like to work on in the near future:</p><ul><li>Improved schema diffing</li><li>ts-morph reflection via custom TS compiler plugin</li><li>Query caching</li><li>MS SQL Server support</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="wdyt"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#wdyt" title="Direct link to heading">#</a>WDYT?</h3><p>So thit is MikroORM 4, what do you think about it? What features or changes would you like to see next? Or what part of the documentation should be improved and how?</p><blockquote><p><em>Like</em> <a href="https://mikro-orm.io/"><em>MikroORM</em></a><em>? ⭐️</em> <a href="https://github.com/mikro-orm/mikro-orm"><em>Star it</em></a> <em>on GitHub and share this article with your friends. If you want to support the project financially, you can do so via</em> <a href="https://github.com/sponsors/B4nan"><em>GitHub Sponsors</em></a><em>.</em></p></blockquote></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/typescript">typescript</a><a class="margin-horiz--sm" href="/blog/tags/javascript">javascript</a><a class="margin-horiz--sm" href="/blog/tags/node">node</a><a class="margin-horiz--sm" href="/blog/tags/sql">sql</a></div></footer></article><div class="margin-vert--xl"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/mikro-orm-3-released"><h5 class="pagination-nav__link--sublabel">Next Post</h5><h4 class="pagination-nav__link--label">MikroORM 3: Knex.js, CLI, Schema Updates, Entity Generator and more… »</h4></a></div></nav></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/installation">Installation &amp; Usage</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/mikro-orm/mikro-orm#-quick-start">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/upgrading-v3-to-v4">Migration from v3 to v4</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/3.6/installation">Version 3.6 docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://join.slack.com/t/mikroorm/shared_invite/enQtNTM1ODYzMzM4MDk3LWM4ZDExMjU5ZDhmNjA2MmM3MWMwZmExNjhhNDdiYTMwNWM0MGY5ZTE3ZjkyZTMzOWExNDgyYmMzNDE1NDI5NjA">Slack</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/ask?tags=mikro-orm">Stack Overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a aria-current="page" class="footer__link-item active" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" to="https://twitter.com/MikroOrm" href="https://twitter.com/MikroOrm">Twitter</a></li><li class="footer__item"><iframe src="https://ghbtns.com/github-btn.html?user=mikro-orm&amp;repo=mikro-orm&amp;type=star&amp;count=true" style="margin-top:10px" frameborder="0" scrolling="0" width="100" height="30" title="GitHub Stars"></iframe></li><li class="footer__item"><iframe src="https://ghbtns.com/github-btn.html?user=B4nan&amp;type=sponsor" frameborder="0" scrolling="0" width="130" height="30" title="Sponsor B4nan"></iframe></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="MikroORM" src="/img/logo-header.svg"></div>Copyright © 2018-2020 Martin Adámek. Built with Docusaurus. Icons made by <a href="https://www.flaticon.com/authors/surang" title="surang">surang</a> and <a href="https://www.flaticon.com/authors/skyclick" title="Skyclick">Skyclick</a>.</div></div></footer>
</div>

<script src="/styles.ab677cec.js"></script>

<script src="/runtime~main.1a7df383.js"></script>

<script src="/main.c2ef541e.js"></script>

<script src="/1.7f8e4ee9.js"></script>

<script src="/2.062ceb4d.js"></script>

<script src="/3.885aa520.js"></script>

<script src="/ccc49370.3426701b.js"></script>

<script src="/8f6b4fa6.5840ddae.js"></script>


</body>
</html>